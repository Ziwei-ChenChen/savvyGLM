<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generalized Linear Models Fitting with Slab and Shrinkage Estimators — savvy_glm.fit2 • savvyGLM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.2.1/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.2.1/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Linear Models Fitting with Slab and Shrinkage Estimators — savvy_glm.fit2"><meta name="description" content="savvy_glm.fit2 is a modified version of glm.fit that enhances the standard iteratively reweighted least squares (IRLS) algorithm by incorporating a set of shrinkage estimator functions.
These functions (namely St_ost, DSh_ost, SR_ost, GSR_ost, and optionally Sh_ost) provide alternative coefficient updates based on shrinkage principles.
The function allows the user to select one or more of these methods via the model_class argument."><meta property="og:description" content="savvy_glm.fit2 is a modified version of glm.fit that enhances the standard iteratively reweighted least squares (IRLS) algorithm by incorporating a set of shrinkage estimator functions.
These functions (namely St_ost, DSh_ost, SR_ost, GSR_ost, and optionally Sh_ost) provide alternative coefficient updates based on shrinkage principles.
The function allows the user to select one or more of these methods via the model_class argument."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">savvyGLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/savvyGLM.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generalized Linear Models Fitting with Slab and Shrinkage Estimators</h1>

      <div class="d-none name"><code>savvy_glm.fit2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>savvy_glm.fit2</code> is a modified version of <code>glm.fit</code> that enhances the standard iteratively reweighted least squares (IRLS) algorithm by incorporating a set of shrinkage estimator functions.
These functions (namely <code>St_ost</code>, <code>DSh_ost</code>, <code>SR_ost</code>, <code>GSR_ost</code>, and optionally <code>Sh_ost</code>) provide alternative coefficient updates based on shrinkage principles.
The function allows the user to select one or more of these methods via the <code>model_class</code> argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">savvy_glm.fit2</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">nobs</span><span class="op">)</span>,</span>
<span>                        model_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"St"</span>, <span class="st">"DSh"</span>, <span class="st">"SR"</span>, <span class="st">"GSR"</span>, <span class="st">"Sh"</span><span class="op">)</span>,</span>
<span>                        start <span class="op">=</span> <span class="cn">NULL</span>, etastart <span class="op">=</span> <span class="cn">NULL</span>, mustart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                        offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nobs</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        use_parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numeric matrix of predictors. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numeric vector of responses. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>An optional vector of weights to be used in the fitting process. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-model-class">model_class<a class="anchor" aria-label="anchor" href="#arg-model-class"></a></dt>
<dd><p>A character vector specifying the shrinkage model(s) to be used.
Allowed values are <code>"St"</code>, <code>"DSh"</code>, <code>"SR"</code>, <code>"GSR"</code>, and <code>"Sh"</code>.
If a single value is provided, only that method is run. If multiple values are provided,
the function runs the specified methods in parallel (if <code>use_parallel = TRUE</code>) and returns the best one based on Akaike Information Criterion (AIC).
When the user does not explicitly supply a value for <code>model_class</code>, the default is <code>c("St", "DSh", "SR", "GSR")</code> (i.e. <code>"Sh"</code> is not considered).</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>Starting values for the parameters. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-etastart">etastart<a class="anchor" aria-label="anchor" href="#arg-etastart"></a></dt>
<dd><p>Starting values for the linear predictor. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-mustart">mustart<a class="anchor" aria-label="anchor" href="#arg-mustart"></a></dt>
<dd><p>Starting values for the mean. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>An optional offset to be included in the model. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A description of the error distribution and link function to be used in the model. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of parameters for controlling the fitting process. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>A logical value indicating whether an intercept should be included in the model, defalut is <code>TRUE</code>. As for <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>.</p></dd>


<dt id="arg-use-parallel">use_parallel<a class="anchor" aria-label="anchor" href="#arg-use-parallel"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, enables parallel execution of the fitting process.
Defaults to <code>TRUE</code>. Set to <code>FALSE</code> for serial execution.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The value returned by <code>savvy_glm.fit2</code> has the same structure as the value returned by <code>glm.fit</code>. It includes the following components:</p>
<dl><dt>coefficients</dt>
<dd><p>the estimated coefficients.</p></dd>

<dt>residuals</dt>
<dd><p>the working residuals, that is the residuals in the final iteration of the IWLS fit.</p></dd>

<dt>fitted.values</dt>
<dd><p>the fitted mean values, obtained by transforming the linear predictors by the inverse of the link function.</p></dd>

<dt>R</dt>
<dd><p>the upper-triangular factor of the QR decomposition of the weighted model matrix.</p></dd>

<dt>rank</dt>
<dd><p>the numeric rank of the fitted linear model.</p></dd>

<dt>qr</dt>
<dd><p>the QR decomposition of the weighted model matrix.</p></dd>

<dt>family</dt>
<dd><p>the family object used.</p></dd>

<dt>linear.predictors</dt>
<dd><p>the final linear predictors.</p></dd>

<dt>deviance</dt>
<dd><p>the deviance of the final model.</p></dd>

<dt>aic</dt>
<dd><p>the AIC of the final model.</p></dd>

<dt>null.deviance</dt>
<dd><p>the deviance for the null model.</p></dd>

<dt>iter</dt>
<dd><p>the number of iterations used.</p></dd>

<dt>weights</dt>
<dd><p>the final weights used in the fitting process.</p></dd>

<dt>prior.weights</dt>
<dd><p>the weights initially supplied.</p></dd>

<dt>df.residual</dt>
<dd><p>the residual degrees of freedom.</p></dd>

<dt>df.null</dt>
<dd><p>the residual degrees of freedom for the null model.</p></dd>

<dt>y</dt>
<dd><p>the response vector used.</p></dd>

<dt>converged</dt>
<dd><p>a logical value indicating whether the IRLS iterations converged.</p></dd>

<dt>boundary</dt>
<dd><p>a logical value indicating whether the algorithm stopped at a boundary value.</p></dd>

<dt>time</dt>
<dd><p>the time taken for the fitting process.</p></dd>

<dt>chosen_fit</dt>
<dd><p>the name of the chosen fitting method based on AIC.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>savvy_glm.fit2</code> extends the classical Generalized Linear Model (GLM) fitting procedure by evaluating a collection of shrinkage‐based updates during each iteration of the IRLS algorithm.
When multiple shrinkage methods are specified in <code>model_class</code> (the default is <code>c("St", "DSh", "SR", "GSR")</code>, thereby excluding <code>"Sh"</code> unless explicitly provided),
if the user explicitly includes <code>"Sh"</code> (for example, <code>model_class = c("St", "DSh", "SR", "GSR", "Sh")</code> or <code>model_class = c("St", "Sh")</code>),
then the method <code>Sh_ost</code> is also evaluated.</p>
<p>The function can run these candidate methods in parallel (if <code>use_parallel = TRUE</code>). The final model is selected based on the lowest AIC.
In cases where any candidate model returns an <code>NA</code> or non-finite AIC (which may occur when using quasi-likelihood families),
the deviance is used uniformly as the model-selection criterion instead.</p>
<p>In essence, the function starts with initial estimates (via <code>start</code>, <code>etastart</code>, or <code>mustart</code>)
and iteratively updates the coefficients using the chosen shrinkage method(s).
The incorporation of these shrinkage estimators aims to improve convergence properties and to yield more stable or parsimonious models under various data scenarios.
<strong>Shrinkage Estimators Used in the IRLS Algorithm:</strong></p><dl><dt><strong>Stein Estimator (St)</strong></dt>
<dd><p></p><ul><li><p>Computes a single multiplicative shrinkage factor applied uniformly to all coefficients.</p></li>
<li><p>The factor is chosen to minimize the overall mean squared error (MSE) of the OLS estimator.</p></li>
<li><p>Best suited when the predictors are similarly scaled so that uniform shrinkage is appropriate.</p></li>
</ul><p></p></dd>


  <dt><strong>Diagonal Shrinkage (DSh)</strong></dt>
<dd><p></p><ul><li><p>Extends the Stein estimator by calculating an individual shrinkage factor for each coefficient.</p></li>
<li><p>Each factor is derived from the magnitude and variance of the corresponding coefficient.</p></li>
<li><p>Provides enhanced flexibility when predictor scales or contributions differ.</p></li>
</ul><p></p></dd>


  <dt><strong>Simple Slab Regression (SR)</strong></dt>
<dd><p></p><ul><li><p>Penalizes the projection of the OLS estimator along a fixed, predefined direction.</p></li>
<li><p>Uses a closed-form solution under a slab (fixed-penalty) constraint.</p></li>
<li><p>Suitable when prior information suggests shrinking the coefficients along a known direction.</p></li>
</ul><p></p></dd>


  <dt><strong>Generalized Slab Regression (GSR)</strong></dt>
<dd><p></p><ul><li><p>Generalizes SR by incorporating multiple, data-adaptive shrinkage directions.</p></li>
<li><p>Typically employs the leading eigenvectors of the design matrix as the directions.</p></li>
<li><p>Provides adaptive regularization that effectively handles multicollinearity.</p></li>
</ul><p></p></dd>


  <dt><strong>Shrinkage Estimator (Sh)</strong></dt>
<dd><p></p><ul><li><p>Computes a non-diagonal shrinkage matrix by solving a <em>Sylvester equation</em>.</p></li>
<li><p>Transforms the OLS estimator to achieve a lower mean squared error.</p></li>
<li><p>This estimator is evaluated only when <code>"Sh"</code> is explicitly included in the <code>model_class</code> argument.</p></li>
</ul><p></p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Marschner, I. C. (2011). <em>glm2: Fitting Generalized Linear Models with Convergence Problems</em>.
The R Journal, 3(2), 12–15. doi:10.32614/RJ-2011-012. Available at:
<a href="https://doi.org/10.32614/RJ-2011-012" class="external-link">https://doi.org/10.32614/RJ-2011-012</a>.</p>
<p>Asimit, V., Cidota, M. A., Chen, Z., &amp; Asimit, J. (2025). <em>Slab and Shrinkage Linear Regression Estimation</em>.
Retrieved from <a href="https://openaccess.city.ac.uk/id/eprint/35005/" class="external-link">https://openaccess.city.ac.uk/id/eprint/35005/</a>.</p>
<p>SavvyGLM article. <a href="https://ziwei-chenchen.github.io/savvyGLM" class="external-link">https://ziwei-chenchen.github.io/savvyGLM</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code>, <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>, <code>glm.fit2</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ziwei Chen and Vali Asimit<br>
Maintainer: Ziwei Chen &lt;ziwei.chen.3@citystgeorges.ac.uk&gt;</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ziwei Chen, Vali Asimit.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

